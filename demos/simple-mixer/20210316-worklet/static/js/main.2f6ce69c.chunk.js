(this["webpackJsonpsimple-mixer"]=this["webpackJsonpsimple-mixer"]||[]).push([[0],{24:function(e){e.exports=JSON.parse('{"en":{"title":"KG\'s Simple Mixer for stem files with speed/pitch control","alert":"Select stereo audio file(s) first!","switchLang":"\u65e5\u672c\u8a9e\u306b\u5207\u308a\u66ff\u3048","worklet":"AudioWorklet on/off only if supported","fileReader":"Select stereo audio file(s) at once or add one by one. Local or on a cloud drive","clearButton":"Clear","clearFiles":"Clear all imported files","timeTitle":"Time","timeSlider":"Pause or Stop playback to move","timeSliderPosition":"Slider position","setA":"Set timeA at slider position","setB":"Set timeB at slider position","resetAB":"Reset Time A and B","playerTitle":"Player Controls","record":"Turn on/off voice recording (not implemented yet)","playButton":"Play/Pause/Resume","stopButton":"Stop and rewind to timeA","loopButton":"Loop on/off (with 2 sec interval)","exportButton":"Supports speed > 100%. Export the mix (download and play)","playMixButton":"Supports speed > 100%. Process and play the mix once","bypassButton":"Bypass Speed/Pitch control","speedTitle1":"Speed","speedTitle2":"(50 -- 200, real-time<= 100)","pitchTitle":"Pitch","masterGainTitle":"Master Gain","trackGainTitle":"Track Gain(s)","version":"Version","url":"https://goto920.github.io/demos/simple-mixer/","guide":"Guide/Update","credit":"Speed/pitch control by modified"},"ja":{"title":"KG\u306estem\u30d5\u30a1\u30a4\u30eb\u7528\u30b7\u30f3\u30d7\u30eb\u30df\u30ad\u30b5\u30fc \u901f\u5ea6/\u30d4\u30c3\u30c1(\u97f3\u7a0b) \u30b3\u30f3\u30c8\u30ed\u30fc\u30eb\u4ed8\u304d","alert":"\u6700\u521d\u306b1\u3064\u4ee5\u4e0a\u306e\u30b9\u30c6\u30ec\u30aa\u97f3\u58f0\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u3093\u3067\u306d","switchLang":"Switch to English","worklet":"\u4f7f\u3048\u308b\u5834\u5408\u306fAudioWorklet on/off","fileReader":"\u30ed\u30fc\u30ab\u30eb\u307e\u305f\u306f\u30af\u30e9\u30a6\u30c9\u30c9\u30e9\u30a4\u30d6\u4e0a\u306e1\u3064\u4ee5\u4e0a\u306e\u30b9\u30c6\u30ec\u30aa\u97f3\u58f0\u30d5\u30a1\u30a4\u30eb\u3092\u307e\u3068\u3081\u3066\u3001\u307e\u305f\u306f1\u3064\u305a\u3064\u8ffd\u52a0","clearButton":"\u30af\u30ea\u30a2","clearFiles":"\u8aad\u307f\u8fbc\u3093\u3060\u30d5\u30a1\u30a4\u30eb\u306e\u5168\u6d88\u53bb","timeTitle":"\u6642\u9593","timeSliderPosition":"\u30b9\u30e9\u30a4\u30c0\u4f4d\u7f6e","timeSlider":"\u518d\u751f\u3092\u4e00\u6642\u505c\u6b62/\u7d42\u4e86\u3057\u3066\u52d5\u304b\u3057\u3066\u306d","setA":"\u30b9\u30e9\u30a4\u30c0\u4f4d\u7f6e\u306btimeA\u3092\u30bb\u30c3\u30c8","setB":"\u30b9\u30e9\u30a4\u30c0\u4f4d\u7f6e\u306btimeB\u3092\u30bb\u30c3\u30c8","resetAB":"Time A and B\u3092\u30ea\u30bb\u30c3\u30c8","playerTitle":"\u30d7\u30ec\u30fc\u30e4\u64cd\u4f5c","record":"\u97f3\u58f0\u9332\u97f3 on/off (\u672a\u5b9f\u88c5)","playButton":"\u518d\u751f/\u4e00\u6642\u505c\u6b62/\u518d\u958b","stopButton":"\u518d\u751f\u7d42\u4e86\u3057\u3066timeA\u306b\u623b\u3059","loopButton":"\u30eb\u30fc\u30d7on/off (2\u79d2\u9593\u9694)","exportButton":"\u901f\u5ea6 > 100%\u3082OK! \u30df\u30c3\u30af\u30b9\u3092\u30a8\u30af\u30b9\u30dd\u30fc\u30c8 (\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u518d\u751f\u7528)","playMixButton":" \u901f\u5ea6> 100%\u3082OK! \u30df\u30c3\u30af\u30b9\u51e6\u7406\u5f8c\u4e00\u56de\u518d\u751f","bypassButton":"\u901f\u5ea6/\u97f3\u7a0b\u5909\u66f4\u3092\u30d0\u30a4\u30d1\u30b9","speedTitle1":"\u518d\u751f\u901f\u5ea6","speedTitle2":"(50 -- 200, \u5b9f\u6642\u9593<= 100)","pitchTitle":"\u97f3\u7a0b","masterGainTitle":"\u30de\u30b9\u30bf\u30fc\u30b2\u30a4\u30f3","trackGainTitle":"\u30c8\u30e9\u30c3\u30af\u30b2\u30a4\u30f3","version":"\u30d0\u30fc\u30b8\u30e7\u30f3","url":"https://goto920.github.io/demos/simple-mixer/index-jp.html","guide":"\u30ac\u30a4\u30c9/\u66f4\u65b0","credit":"\u901f\u5ea6/\u30d4\u30c3\u30c1\u5909\u66f4\u306f\u4fee\u6b63\u3057\u305f"}}')},46:function(e){e.exports=JSON.parse('{"name":"simple-mixer","version":"0.1.0","private":true,"homepage":".","subversion":"20210316-10","dependencies":{"@material-ui/core":"^4.11.3","@material-ui/icons":"^4.11.2","@testing-library/jest-dom":"^5.11.9","@testing-library/react":"^11.2.5","@testing-library/user-event":"^12.7.3","audiobuffer-to-wav":"^1.0.0","file-saver":"^2.0.5","import":"0.0.6","rc-slider":"^9.7.1","react":"^17.0.1","react-bootstrap-icons":"^1.3.0","react-dom":"^17.0.1","react-scripts":"4.0.3","reactstrap":"^8.9.0","soundtouchjs":"^0.1.26","web-vitals":"^0.2.4","workbox-background-sync":"^5.1.4","workbox-broadcast-update":"^5.1.4","workbox-cacheable-response":"^5.1.4","workbox-core":"^5.1.4","workbox-expiration":"^5.1.4","workbox-google-analytics":"^5.1.4","workbox-navigation-preload":"^5.1.4","workbox-precaching":"^5.1.4","workbox-range-requests":"^5.1.4","workbox-routing":"^5.1.4","workbox-strategies":"^5.1.4","workbox-streams":"^5.1.4"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":["react-app","react-app/jest"]},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]},"devDependencies":{"browser-resolve":"^2.0.0","esmify":"^2.1.1"}}')},59:function(e,t,i){},77:function(e,t,i){},85:function(e,t,i){"use strict";i.r(t);var a=i(1),n=i(10),s=i.n(n),r=(i(77),i(13)),o=i.n(r),l=i(26),c=i(4),u=i(5),d=i(6),h=i(7),p=i(8),g=(i(59),i(55)),f=function(){},m=function(e){Object(h.a)(i,e);var t=Object(p.a)(i);function i(e){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f;return Object(c.a)(this,i),(a=t.call(this,null,e,n)).callback=n,a.sourceSound=[],a.historyBufferSize=22050,a._sourcePosition=0,a.outputBufferPosition=0,a._position=0,a}return Object(u.a)(i,[{key:"putSource",value:function(e){for(var t=0;t<e.length;t++)this.sourceSound.push(e[t])}},{key:"extractSource",value:function(e,t){var i=0;return this.sourceSound.length<2*t?i=0:(e.set(this.sourceSound.slice(0,2*t)),this.sourceSound.splice(0,2*t),i=t),i}},{key:"fillInputBuffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=new Float32Array(2*e),i=this.extractSource(t,e);i>0&&this.inputBuffer.putSamples(t,0,i)}}]),i}(g.a),b=i(43),j=i(44),x=function(){},y=function(){function e(t,i,a){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(c.a)(this,e),console.log("new MyPitchShifter instance"),this.context=t,this.bufferSize=a,this.record=n,this.bypass=s,this.recordedSamples=[[],[]],this.lastPlayingAt=0,this._soundtouch=new g.b,this._filter=new m(this._soundtouch,x),this._onEnd=x,this._onUpdate=x,this._updateInterval=.5,this._node=t.createScriptProcessor(a,2,2),this._node.onaudioprocess=this.onaudioprocess.bind(this),this._totalInputFrames=i,this._recordedBuffer=null,this._nVirtualOutputFrames=0,this._playingAt=0,this.outSamples=new Float32Array(2*a),this.inSamples=new Float32Array(2*a),this.sampleRate=t.sampleRate,this.nInputFrames=0}return Object(u.a)(e,[{key:"totalInputFrames",get:function(){return this._totalInputFrames},set:function(e){this._totalInputFrames=e}},{key:"totalVirtualOutputFrames",get:function(){return this._nVirtualOutputFrames}},{key:"playingAt",get:function(){return this._playingAt}},{key:"node",get:function(){return this._node}},{key:"tempo",get:function(){return this._soundtouch.tempo},set:function(e){this._soundtouch.tempo=e}},{key:"pitch",set:function(e){this._soundtouch.pitch=e}},{key:"rate",get:function(){return this._soundtouch.rate}},{key:"recordedBuffer",get:function(){return null===this._recordedBuffer&&this.createProcessedBuffer(),this._recordedBuffer}},{key:"onEnd",set:function(e){this._onEnd=e}},{key:"onUpdate",set:function(e){this._onUpdate=e}},{key:"updateInterval",get:function(){return this._updateInterval},set:function(e){this._updateInterval=e}},{key:"stop",value:function(){this._node.onaudioprocess&&(console.log(this.name,"shifter stop"),this._node.onaudioprocess=null,this._node.disconnect(),null===this._recordedBuffer&&this.createProcessedBuffer(),this._onEnd(this._recordedBuffer))}},{key:"createProcessedBuffer",value:function(){if(this.record){var e=this.context.createBuffer(this.recordedSamples.length,this.recordedSamples[0].length,this.sampleRate),t=e.getChannelData(0),i=e.getChannelData(1);t.set(this.recordedSamples[0]),i.set(this.recordedSamples[1]),this._recordedBuffer=e}}},{key:"onaudioprocess",value:function(e){if(this.bypass)this._nVirtualOutputFrames<=this._totalInputFrames?(this.passThrough(e.inputBuffer,e.outputBuffer),this._nVirtualOutputFrames+=e.outputBuffer.length):this.stop();else if(this._nVirtualOutputFrames<=this._totalInputFrames){var t=this.process(e.inputBuffer,e.outputBuffer);this._nVirtualOutputFrames+=t*this._soundtouch.tempo}else this.stop();return this._playingAt=this._nVirtualOutputFrames/this.sampleRate,this.playingAt-this.lastPlayingAt>=this._updateInterval&&(this._onUpdate(this._playingAt),this.lastPlayingAt=this._playingAt),this.nInputFrames+=e.inputBuffer.length,!0}},{key:"process",value:function(e,t){for(var i=e.getChannelData(0),a=e.getChannelData(1),n=this.inSamples,s=t.getChannelData(0),r=t.getChannelData(1),o=0;o<e.length;o++)n[2*o]=i[o],n[2*o+1]=a[o];this._filter.putSource(n);for(var l=this.outSamples,c=this._filter.extract(l,this.bufferSize),u=0;u<c;u++)s[u]=l[2*u],r[u]=l[2*u+1],this.record&&(this.recordedSamples[0].push(s[u]),this.recordedSamples[1].push(r[u]));return c}},{key:"passThrough",value:function(e,t){for(var i=t.numberOfChannels,a=0;a<i;a++){var n=e.getChannelData(a);if(t.getChannelData(a).set(e.getChannelData(a)),this.record)for(var s=0;s<t.length;s++)this.recordedSamples[a].push(n[s])}}},{key:"exportToFile",value:function(e){if(this.record){console.log("exportToFile: ",e,"length: ",this.recordedSamples[0].length),null===this._recordedBuffer&&this.createProcessedBuffer();var t=new Blob([j(this._recordedBuffer)],{type:"audio/vnd.wav"});Object(b.saveAs)(t,e)}}}]),e}(),O=i(69),v=function(){},A=function(e){return new Promise((function(t){return setTimeout(t,e)}))},k=function(e){Object(h.a)(i,e);var t=Object(p.a)(i);function i(e,a,n){var s;return Object(c.a)(this,i),(s=t.call(this,e,a,n)).name=s.constructor.name,s.recording=n.processorOptions.recording,s.sampleRate=n.processorOptions.sampleRate,s.port.onmessage=s.messageProcessor.bind(Object(d.a)(s)),s._onUpdate=v,s._onEnd=v,s.recordedSamples=null,s._recordedBuffer=null,s.running=!0,s}return Object(u.a)(i,[{key:"node",get:function(){return this}},{key:"onEnd",set:function(e){this._onEnd=e}},{key:"onUpdate",set:function(e){this._onUpdate=e}},{key:"onUpdateInterval",set:function(e){this.port.postMessage({command:"onUpdateInterval",args:[e]})}},{key:"tempo",get:function(){return this.port.postMessage({command:"getTempo",args:[]}),this.tempo},set:function(e){this.port.postMessage({command:"setTempo",args:[e]})}},{key:"pitch",get:function(){return this.port.postMessage({command:"getPitch",args:[]}),this.pitch},set:function(e){this.port.postMessage({command:"setPitch",args:[e]})}},{key:"recordedBuffer",get:function(){return this._recordedBuffer}},{key:"stop",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.running){e.next=2;break}return e.abrupt("return");case 2:return console.log(this.name,".stop()"),e.next=5,this.port.postMessage({command:"stop",args:[]});case 5:return this.disconnect(),console.log(this.name,"sleep begin"),e.next=9,A(3e3);case 9:console.log(this.name,"sleep end"),this._onEnd(this._recordedBuffer),this.running=!1;case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"messageProcessor",value:function(e){if(e.data.command){var t=e.data,i=t.command,a=t.args;switch(i){case"End":console.log(this.name,"recvd",i),this.recordedSamples=a[0],this.recordedSamples?console.log(this.name,"worklet stopped. recordedSamples"):console.log(this.name,"worklet stopped. NO recordedSamples"),this.recording&&this.createRecordedBuffer(),this.stop();break;case"update":this._onUpdate(a[0])}}else if(e.data.status){var n=e.data.args[1];switch(e.data.args[0]){case"getTempo":this.tempo=n;break;case"getPitch":this.pitch=n}}else;}},{key:"exportToFile",value:function(e){if(this.recording)if(this._recordedBuffer){var t=new Blob([j(this._recordedBuffer)],{type:"audio/vnd.wav"});Object(b.saveAs)(t,e)}else console.log(this.name,"recordedBuffer is null! Cannot export")}},{key:"createRecordedBuffer",value:function(){if(this.recordedSamples){if(0===this.recordedSamples[0].length)return null;this._recordedBuffer=this.context.createBuffer(this.recordedSamples.length,this.recordedSamples[0].length,this.sampleRate);var e=this._recordedBuffer.getChannelData(0),t=this._recordedBuffer.getChannelData(1);return e.set(this.recordedSamples[0]),t.set(this.recordedSamples[1]),console.log(this.name,"createRecordedBuffer done"),this._recordedBuffer}console.log(this.name,"this.recordedBuffer empty")}}]),i}(Object(O.a)(AudioWorkletNode)),S=i(103),B=i(104),P=i(56),w=i.n(P),C=i(68),N=i.n(C),F=i(0),_=function(e){Object(h.a)(i,e);var t=Object(p.a)(i);function i(e){var a;return Object(c.a)(this,i),(a=t.call(this)).state={nextAction:e.nextAction,m:e.messages},a.handler=e.handler,a}return Object(u.a)(i,[{key:"componentDidUpdate",value:function(e){e.nextAction!==this.props.nextAction&&this.setState({nextAction:this.props.nextAction}),e.messages!==this.props.messages&&this.setState({m:this.props.messages})}},{key:"render",value:function(){var e=this,t=this.state,i=t.nextAction,a=t.m,n=null;switch(i){case"load files first!":n=Object(F.jsx)(S.a,{title:a.alert,children:Object(F.jsx)("span",{children:Object(F.jsx)(B.a,{onClick:function(){return e.handler({target:{name:"startPause"}})},children:Object(F.jsx)(w.a,{color:"disabled"})})})});break;case"Play":n=Object(F.jsx)(S.a,{title:a.playButton,children:Object(F.jsx)(B.a,{onClick:function(){return e.handler({target:{name:"startPause"}})},children:Object(F.jsx)(w.a,{color:"primary"})})});break;case"Resume":n=Object(F.jsx)(B.a,{onClick:function(){return e.handler({target:{name:"startPause"}})},children:Object(F.jsx)(w.a,{style:{color:"#00aa00"}})});break;case"Pause":n=Object(F.jsx)(B.a,{onClick:function(){return e.handler({target:{name:"startPause"}})},children:Object(F.jsx)(N.a,{color:"primary"})});break;default:n="undefined"}return Object(F.jsx)("span",{children:n})}}]),i}(a.Component),T=i(39),G=i.n(T),W=i(38),M=i.n(W),R=function(e){Object(h.a)(i,e);var t=Object(p.a)(i);function i(e){var a;return Object(c.a)(this,i),(a=t.call(this)).state={playSpeed:e.playSpeed,playPitch:e.playPitch,m:e.messages},a.setSpeed=e.setSpeed,a.setPitch=e.setPitch,a}return Object(u.a)(i,[{key:"componentDidUpdate",value:function(e){e.playSpeed!==this.props.playSpeed&&this.setState({playSpeed:this.props.playSpeed}),e.playPitch!==this.props.playPitch&&this.setState({playPitch:this.props.playPitch}),e.messages!==this.props.messages&&this.setState({m:this.props.messages})}},{key:"render",value:function(){var e=this,t=this.state.m;return Object(F.jsx)("span",{children:Object(F.jsxs)("span",{children:[Object(F.jsxs)("div",{className:"text-divider",children:[t.speedTitle1,"(",Object(F.jsxs)("font",{color:"green",children:[(100*this.state.playSpeed).toFixed(0),"%)"]}),"\xa0 ",t.speedTitle2]}),Object(F.jsxs)("center",{children:["\xb1 10% ",Object(F.jsxs)(B.a,{onClick:function(){return e.setSpeed({target:{name:"sub10"}})},children:[Object(F.jsx)(M.a,{color:"primary"})," "]}),Object(F.jsxs)(B.a,{onClick:function(){return e.setSpeed({target:{name:"add10"}})},children:[Object(F.jsx)(G.a,{color:"primary"})," "]}),"\xa0\xa0\xa0 \xb1 1% ",Object(F.jsxs)(B.a,{onClick:function(){return e.setSpeed({target:{name:"sub1"}})},children:[Object(F.jsx)(M.a,{color:"primary"})," "]}),Object(F.jsxs)(B.a,{onClick:function(){return e.setSpeed({target:{name:"add1"}})},children:[Object(F.jsx)(G.a,{color:"primary"})," "]})]}),Object(F.jsxs)("div",{className:"text-divider",children:[t.pitchTitle,"\xa0 (",Object(F.jsx)("font",{color:"green",children:this.state.playPitch.toFixed(1)}),") (-12 -- +12)"]}),Object(F.jsxs)("center",{children:["b/# ",Object(F.jsxs)(B.a,{onClick:function(){return e.setPitch({target:{name:"sub1"}})},children:[Object(F.jsx)(M.a,{color:"primary"})," "]}),Object(F.jsxs)(B.a,{onClick:function(){return e.setPitch({target:{name:"add1"}})},children:[Object(F.jsx)(G.a,{color:"primary"})," "]}),"\xa0\xa0\xa0 \xb1 10 cents ",Object(F.jsxs)(B.a,{onClick:function(){return e.setPitch({target:{name:"sub10c"}})},children:[Object(F.jsx)(M.a,{color:"primary"})," "]}),Object(F.jsxs)(B.a,{onClick:function(){return e.setPitch({target:{name:"add10c"}})},children:[Object(F.jsx)(G.a,{color:"primary"})," "]})]})]})})}}]),i}(a.Component),I=function(e){Object(h.a)(i,e);var t=Object(p.a)(i);function i(e){var a;return Object(c.a)(this,i),(a=t.call(this)).state={gain:e.gain},a.id=e.id,a.trackName=e.trackName,a.handler=e.handler,a}return Object(u.a)(i,[{key:"componentDidUpdate",value:function(e){e.gain!==this.props.gain&&this.setState({gain:this.props.gain})}},{key:"render",value:function(){return void 0===this.state.gain||void 0===!this.trackName?null:Object(F.jsxs)("div",{className:"slider",children:[this.trackName," (",this.state.gain,")",Object(F.jsx)("br",{}),"0 ",Object(F.jsx)("input",{type:"range",id:this.id,name:"gainSlider",min:"0",max:"100",value:this.state.gain,onChange:this.handler})," 100"]})}}]),i}(a.Component),D=function(e){Object(h.a)(i,e);var t=Object(p.a)(i);function i(e){var a;return Object(c.a)(this,i),(a=t.call(this)).inputAudio=e.inputAudio,a.handler=e.handler,a.state={gains:e.gains},a}return Object(u.a)(i,[{key:"componentDidUpdate",value:function(e){e.inputAudio!==this.props.inputAudio&&this.setState({inputAudio:this.props.inputAudio}),e.gains!==this.props.gains&&this.setState({gains:this.props.gains})}},{key:"render",value:function(){return this.inputAudio.length>9?null:Object(F.jsx)("div",{children:Object(F.jsxs)("center",{children:[this.inputAudio[0]?Object(F.jsx)(I,{id:0,trackName:this.inputAudio[0].name,gain:this.state.gains[0],handler:this.handler}):null,this.inputAudio[1]?Object(F.jsx)(I,{id:1,trackName:this.inputAudio[1].name,gain:this.state.gains[1],handler:this.handler}):null,this.inputAudio[2]?Object(F.jsx)(I,{id:2,trackName:this.inputAudio[2].name,gain:this.state.gains[2],handler:this.handler}):null,this.inputAudio[3]?Object(F.jsx)(I,{id:3,trackName:this.inputAudio[3].name,gain:this.state.gains[3],handler:this.handler}):null,this.inputAudio[4]?Object(F.jsx)(I,{id:4,trackName:this.inputAudio[4].name,gain:this.state.gains[4],handler:this.handler}):null,this.inputAudio[5]?Object(F.jsx)(I,{id:5,trackName:this.inputAudio[5].name,gain:this.state.gains[5],handler:this.handler}):null,this.inputAudio[6]?Object(F.jsx)(I,{id:6,trackName:this.inputAudio[6].name,gain:this.state.gains[6],handler:this.handler}):null,this.inputAudio[7]?Object(F.jsx)(I,{id:7,trackName:this.inputAudio[7].name,gain:this.state.gains[7],handler:this.handler}):null,this.inputAudio[8]?Object(F.jsx)(I,{id:8,trackName:this.inputAudio[8].name,gain:this.state.gains[8],handler:this.handler}):null]})})}}]),i}(a.Component),U=i(46),E=i(24),L=i(49),J=i.n(L),V=i(50),Z=i.n(V),K=i(51),z=i.n(K),q=i(52),$=i.n(q),H=i(53),Q=i.n(H),X=i(47),Y=i.n(X),ee=i(48),te=i.n(ee),ie=U.subversion,ae="en",ne=E.en;console.log(window.navigator.language),"ja"===window.navigator.language.slice(0,2)&&(ae="ja",ne=E.ja);var se=!1;OfflineAudioContext?(se=!0,console.log("OfflineAudioContext available")):se=!1;var re=se,oe=!1;(window.AudioWorkletNode||window.webkitAudioWorkletNode)&&(oe=!0,console.log("AudioWorkletNode available"));var le=new AudioContext,ce=!1;le.audioWorklet&&"function"===typeof le.audioWorklet.addModule&&(ce=!0,console.log("Audiocontext.AudioWorklet available")),le.close();var ue=oe&ce,de=function(e){Object(h.a)(i,e);var t=Object(p.a)(i);function i(e){var a;return Object(c.a)(this,i),(a=t.call(this)).audioCtx=null,a.inputAudio=[],a.mixedSource=null,a.masterGainNode=null,a.state={language:ae,isPlaying:!1,timeA:0,playingAt:0,timeB:0,loop:!1,loopDelay:2,playButtonNextAction:"load files first!",gains:[],masterGain:75,playSpeed:1,playPitch:0,bypass:!1,useAudioWorklet:ue,micOn:!1},a.shifter=null,a.loadFiles=a.loadFiles.bind(Object(d.a)(a)),a.handlePlay=a.handlePlay.bind(Object(d.a)(a)),a.handleGainSlider=a.handleGainSlider.bind(Object(d.a)(a)),a.handleTimeSlider=a.handleTimeSlider.bind(Object(d.a)(a)),a.playAB=a.playAB.bind(Object(d.a)(a)),a.setSpeed=a.setSpeed.bind(Object(d.a)(a)),a.setPitch=a.setPitch.bind(Object(d.a)(a)),a.switchLanguage=a.switchLanguage.bind(Object(d.a)(a)),a}return Object(u.a)(i,[{key:"componentWillUnmount",value:function(){null!==this.audioCtx&&this.audioCtx.close()}},{key:"render",value:function(){var e=this;return Object(F.jsxs)("div",{className:"App",children:[ne.title,Object(F.jsx)("br",{}),Object(F.jsxs)("center",{children:["(language) \u2002",Object(F.jsx)("span",{className:"tiny-button",children:Object(F.jsx)(S.a,{title:ne.switchLang,children:Object(F.jsx)("button",{onClick:this.switchLanguage,children:"ja"===this.state.language?"EN":"JP"})})}),"\u2002(AudioWorklet)",Object(F.jsx)(S.a,{title:ne.worklet,children:Object(F.jsx)(B.a,{name:"toggleWorklet",onClick:function(){oe&&e.setState({useAudioWorklet:!e.state.useAudioWorklet})},children:Object(F.jsx)(Y.a,{color:this.state.useAudioWorklet?"primary":"disabled"})})})]}),Object(F.jsx)("hr",{}),Object(F.jsxs)("span",{className:"selectFile",children:[Object(F.jsx)(S.a,{title:ne.fileReader,children:Object(F.jsx)("input",{type:"file",name:"loadFiles",multiple:!0,accept:"audio/*",onChange:this.loadFiles})}),"\u2003",Object(F.jsx)("span",{className:"tiny-button",children:Object(F.jsx)(S.a,{title:ne.clearFiles,children:Object(F.jsx)("button",{name:"clearFile",onClick:function(){e.setState({gains:[],playButtonNextAction:"load files first!"}),e.inputAudio=[]},children:ne.clearButton})})}),Object(F.jsx)("br",{})]}),Object(F.jsx)("br",{}),Object(F.jsxs)("div",{className:"text-divider",children:[ne.timeTitle,"\xa0 (",ne.timeSliderPosition,":\xa0",Object(F.jsx)("font",{color:"green",children:this.state.playingAt.toFixed(2)}),")"]}),Object(F.jsxs)("center",{children:["A: ",this.state.timeA.toFixed(2)," -- B: ",this.state.timeB.toFixed(2),"\u2003 song length: ",this.inputAudio[0]?this.inputAudio[0].data.duration.toFixed(2):0,Object(F.jsx)("br",{}),Object(F.jsx)("div",{className:"slider",children:Object(F.jsx)(S.a,{title:ne.timeSlider,children:Object(F.jsx)("input",{type:"range",name:"timeSlider",min:"0",max:this.inputAudio[0]?this.inputAudio[0].data.duration:0,value:this.state.playingAt,onChange:this.handleTimeSlider})})}),Object(F.jsxs)("span",{className:"tiny-button",children:[Object(F.jsx)(S.a,{title:ne.setA,children:Object(F.jsx)("button",{name:"setA",onClick:function(){return e.setState({timeA:e.state.playingAt})},children:"set A"})}),"\u2003",Object(F.jsx)(S.a,{title:ne.setB,children:Object(F.jsx)("button",{name:"setB",onClick:function(){return e.setState({timeB:e.state.playingAt})},children:"set B"})}),"\u2003",Object(F.jsx)(S.a,{title:ne.resetAB,children:Object(F.jsx)("button",{name:"reset",onClick:function(){return e.setState({timeA:0,timeB:e.inputAudio[0].data.duration})},children:"reset"})})]})]}),Object(F.jsx)("div",{className:"text-divider",children:ne.playerTitle}),Object(F.jsxs)("center",{children:[Object(F.jsx)(S.a,{title:ne.record,children:Object(F.jsx)(B.a,{onClick:function(){return e.setState({micOn:!e.state.micOn})},children:Object(F.jsx)(te.a,{color:this.state.micOn?"secondary":"primary"})})}),Object(F.jsx)(_,{nextAction:this.state.playButtonNextAction,handler:this.handlePlay,messages:ne}),Object(F.jsx)(S.a,{title:ne.stopButton,children:Object(F.jsx)(B.a,{onClick:function(){return e.handlePlay({target:{name:"stop"}})},children:Object(F.jsx)(J.a,{color:this.inputAudio.length?"primary":"disabled"})})}),Object(F.jsx)(S.a,{title:ne.loopButton,children:Object(F.jsx)(B.a,{onClick:function(){e.setState({loop:!e.state.loop})},children:Object(F.jsx)(Z.a,{color:this.state.loop?"secondary":"primary"})})}),Object(F.jsx)(S.a,{title:ne.exportButton,"aria-label":"exportFile",children:Object(F.jsx)(B.a,{onClick:function(){return e.handlePlay({target:{name:"exportFile"}})},children:Object(F.jsx)(z.a,{color:!this.inputAudio.length||this.state.isPlaying?"disabled":"primary"})})}),Object(F.jsx)(S.a,{title:ne.playMixButton,"aria-label":"playMix",children:Object(F.jsx)(B.a,{onClick:function(){return e.handlePlay({target:{name:"playMix"}})},children:Object(F.jsx)($.a,{color:!this.inputAudio.length||this.state.isPlaying?"disabled":"primary"})})}),Object(F.jsx)(S.a,{title:ne.bypassButton,children:Object(F.jsx)(B.a,{onClick:function(){return e.setState({bypass:!e.state.bypass})},children:Object(F.jsx)(Q.a,{color:this.state.bypass?"disabled":"primary"})})})]}),this.state.bypass?"":Object(F.jsx)(R,{playSpeed:this.state.playSpeed,playPitch:this.state.playPitch,setSpeed:this.setSpeed,setPitch:this.setPitch,messages:ne}),Object(F.jsxs)("div",{className:"slider",children:[Object(F.jsxs)("div",{className:"text-divider",children:[ne.masterGainTitle,"\xa0 (",this.state.masterGain,")"]}),Object(F.jsxs)("center",{children:["0 ",Object(F.jsx)("input",{type:"range",id:"master",name:"gainSlider",min:"0",max:"150",value:this.state.masterGain,onChange:this.handleGainSlider})," 150"]})]},"master"),Object(F.jsx)("div",{className:"text-divider",children:ne.trackGainTitle}),Object(F.jsx)(D,{inputAudio:this.inputAudio,gains:this.state.gains,handler:this.handleGainSlider}),Object(F.jsx)("hr",{}),ne.version,": ",ie," \xa0\xa0",Object(F.jsx)("a",{href:ne.url,target:"_blank",rel:"noreferrer",children:ne.guide}),Object(F.jsx)("br",{}),ne.credit,"\xa0",Object(F.jsx)("a",{href:"https://github.com/cutterbl/SoundTouchJS",target:"_blank",rel:"noreferrer",children:"SoundTouchJs"}),Object(F.jsx)("br",{}),Object(F.jsx)("hr",{})]})}},{key:"loadFiles",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var i,a,n,s=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("loadFiles"===t.target.name){e.next=2;break}return e.abrupt("return");case 2:if(0!==t.target.files.length){e.next=4;break}return e.abrupt("return");case 4:if(i=t.target.files,console.log("loadFiles"),null!==this.audioCtx){e.next=18;break}return console.log("AudioContext"),e.prev=8,this.audioCtx=new AudioContext,e.next=12,this.loadModule(this.audioCtx,"worklet/bundle.js");case 12:console.log("AudioContext worklet module loaded"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),console.log(e.t0);case 18:for(a=function(e){var t=new FileReader;t.onload=function(a){this.audioCtx.decodeAudioData(t.result,function(t){if(2===t.numberOfChannels){this.inputAudio.push({name:i[e].name,data:t,source:null,gainNode:null,gain:100});var a=this.state.gains;a.push(100),this.setState({playButtonNextAction:"Play",timeA:0,playingAt:0,timeB:this.inputAudio[0].data.duration,gains:a})}else alert("Sorry, only stereo files are supported")}.bind(this),(function(e){console.log("decode error: "+e.err)}))}.bind(s),t.onerror=function(e){console.log("File read ",t.error)},t.readAsArrayBuffer(i[e])},n=0;n<i.length;n++)a(n);case 20:case"end":return e.stop()}}),e,this,[[8,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleTimeSlider",value:function(e){"timeSlider"===e.target.name&&(this.state.isPlaying||this.setState({playingAt:parseFloat(e.target.value)}))}},{key:"handlePlay",value:function(e){if(console.log("handlePlay name/button",e.target.name,this.state.playButtonNextAction),0===this.inputAudio.length&&alert(ne.alert),"startPause"!==e.target.name){if("stop"===e.target.name)return this.shifter&&this.shifter.stop(),this.mixedSource&&this.mixedSource.stop(),void this.setState({loop:!1,playButtonNextAction:"Play",playingAt:this.state.timeA});if("exportFile"!==e.target.name&&"playMix"!==e.target.name);else{if(0===this.inputAudio.length||this.state.isPlaying)return;var t=re;this.playAB(0,this.state.timeA,this.state.timeB,!0,t,e.target.name)}}else switch(this.state.playButtonNextAction){case"Pause":console.log("Pause"),this.audioCtx&&this.audioCtx.suspend(),this.setState({playButtonNextAction:"Resume",isPlaying:!1});break;case"Resume":console.log("Resume"),"suspended"===this.audioCtx.state&&this.audioCtx.resume(),this.setState({playButtonNextAction:"Pause",isPlaying:!0});break;case"Play":if(console.log("Play"),0===this.inputAudio.length)break;this.playAB(0,this.state.timeA,this.state.timeB),this.setState({playButtonNextAction:"Pause"});break;default:console.log("default",this.state.playButtonNextAction)}}},{key:"handleGainSlider",value:function(e){if("gainSlider"===e.target.name){if("master"===e.target.id)return this.setState({masterGain:parseFloat(e.target.value)}),void(this.masterGainNode&&(this.masterGainNode.gain.value=parseFloat(e.target.value/100)));var t=parseInt(e.target.id),i=this.state.gains;i[t]=parseInt(e.target.value),this.setState({gains:i}),null!==this.inputAudio[t].gainNode&&(this.inputAudio[t].gainNode.gain.value=parseFloat(e.target.value/100))}}},{key:"setSpeed",value:function(e){var t=this.state.playSpeed;switch(e.target.name){case"sub10":t-=.1;break;case"add10":t+=.1;break;case"sub1":t-=.01;break;case"add1":t+=.01}t<.5?t=.5:t>2&&(t=2),this.shifter&&(this.shifter.tempo=t),this.setState({playSpeed:t})}},{key:"setPitch",value:function(e){var t=this.state.playPitch;switch(e.target.name){case"sub1":t-=1;break;case"add1":t+=1;break;case"sub10c":t-=.1;break;case"add10c":t+=.1}t<-12?t=-12:t>12&&(t=12),this.shifter&&(this.shifter.pitch=Math.pow(2,t/12)),this.setState({playPitch:t})}},{key:"switchLanguage",value:function(e){"ja"===this.state.language?(ne=E.en,this.setState({language:"en"})):(ne=E.ja,this.setState({language:"ja"}))}},{key:"playAB",value:function(){var e=Object(l.a)(o.a.mark((function e(t,i,a){var n,s,r,l,c,u,d,h,p,g,f,m,b,j,x,O,v,A=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=A.length>3&&void 0!==A[3]&&A[3],s=A.length>4&&void 0!==A[4]&&A[4],r=A.length>5&&void 0!==A[5]?A[5]:"none",console.log("playAB","delay, timeA, timeB, recording, offline, exporter = ",t,i,a,n,s,r),!this.state.isPlaying){e.next=6;break}return e.abrupt("return");case 6:if("suspended"===this.audioCtx.state&&this.audioCtx.resume(),l=this.inputAudio[0].data.sampleRate,c=this.inputAudio[0].data.numberOfChannels,u=(a-i)*l,d=Math.max(u,u/this.state.playSpeed),h=null,!s){e.next=20;break}return h=new OfflineAudioContext(c,1.1*d,l),e.next=16,this.loadModule(h,"worklet/bundle.js");case 16:console.log("OfflineAudioContext Worklet module loaded"),OfflineAudioContext.suspend&&h.suspend(),e.next=21;break;case 20:h=this.audioCtx;case 21:if(this.setState({isPlaying:!0}),p=1,s&&(p=10),g={processorOptions:{bypass:this.state.bypass,recording:n,nInputFrames:u,updateInterval:p,sampleRate:l}},f=null,this.state.useAudioWorklet)try{(f=new k(h,"my-soundtouch-processor",g)).updateInterval=p,console.log("AudioWorkletNode functional")}catch(o){console.log(o),f=null,(f=new y(h,u,4096,n,this.state.bypass)).updateInterval=p,console.log("Worklet failed. Fallback to ScriptProcessorNode")}else(f=new y(h,u,4096,n,this.state.bypass)).updateInterval=p;for(s||(this.shifter=f),f.tempo=this.state.playSpeed,f.pitch=Math.pow(2,this.state.playPitch/12),m=0;m<this.inputAudio.length;m++)(b=h.createBufferSource()).buffer=0===m?this.addZeros(h,this.inputAudio[m].data):this.inputAudio[m].data,this.inputAudio[m].source=b,(j=h.createGain()).gain.value=this.state.gains[m]/100,this.inputAudio[m].gainNode=j,b.connect(j),j.connect(f.node);for(s?f.node.connect(h.destination):((x=h.createGain()).gain.value=this.state.masterGain/100,this.masterGainNode=x,f.node.connect(x),x.connect(h.destination)),O=h.currentTime+t,v=0;v<this.inputAudio.length;v++)this.inputAudio[v].source.start(O,i);s&&(console.log("startRendering"),h.startRendering()),f.onUpdate=function(e){this.setState({playingAt:i+e})}.bind(this),s&&(h.oncomplete=function(e){console.log("Offline render complete (data is useless though) length = ",e.renderedBuffer.length)}),f.onEnd=function(e){console.log("shifter onEnd");for(var t=0;t<this.inputAudio.length;t++)this.inputAudio[t].gainNode.disconnect();if(this.setState({isPlaying:!1}),"exportFile"===r)console.log("exportFile",e.length),f.exportToFile("mix_"+Date.now()+".wav"),this.setState({isPlaying:!1});else if("playMix"===r){console.log("playMix",e.length);var i=this.audioCtx;this.setState({isPlaying:!0,playButtonNextAction:"Pause"});var a=i.createBufferSource();this.mixedSource=a,a.buffer=e;var n=i.createGain();this.masterGainNode=n,n.gain.value=this.state.masterGain/100,a.connect(this.masterGainNode),n.connect(i.destination),a.start(),a.onended=function(e){this.mixedSource=null,this.setState({isPlaying:!1})}.bind(this)}}.bind(this);case 38:case"end":return e.stop()}}),e,this)})));return function(t,i,a){return e.apply(this,arguments)}}()},{key:"loadModule",value:function(){var e=Object(l.a)(o.a.mark((function e(t,i,a,n){var s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",!1);case 2:return s=t.constructor.name,e.prev=3,e.next=6,t.audioWorklet.addModule(i);case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(3),console.log(e.t0,s,"AudioWorklet load failed"),e.abrupt("return",null);case 12:return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t,i,a,n){return e.apply(this,arguments)}}()},{key:"addZeros",value:function(e,t){console.log("addZeros");for(var i=e.createBuffer(t.numberOfChannels,2*t.length*1.05,t.sampleRate),a=0;a<i.numberOfChannels;a++){var n=t.getChannelData(a);i.getChannelData(a).set(n)}return i}}]),i}(a.Component),he=U.subversion,pe="en",ge=E.en;console.log(window.navigator.language),"ja"===window.navigator.language.slice(0,2)&&(pe="ja",ge=E.ja);var fe=!1;OfflineAudioContext?(fe=!0,console.log("OfflineAudioContext available")):fe=!1;var me=fe,be=function(e){Object(h.a)(i,e);var t=Object(p.a)(i);function i(e){var a;return Object(c.a)(this,i),(a=t.call(this)).audioCtx=null,a.inputAudio=[],a.mixedSource=null,a.masterGainNode=null,a.state={language:pe,isPlaying:!1,timeA:0,playingAt:0,timeB:0,loop:!1,loopDelay:2,playButtonNextAction:"load files first!",gains:[],masterGain:75,playSpeed:1,playPitch:0,bypass:!1,useAudioWorklet:0,micOn:!1},a.shifter=null,a.loadFiles=a.loadFiles.bind(Object(d.a)(a)),a.handlePlay=a.handlePlay.bind(Object(d.a)(a)),a.handleGainSlider=a.handleGainSlider.bind(Object(d.a)(a)),a.handleTimeSlider=a.handleTimeSlider.bind(Object(d.a)(a)),a.playAB=a.playAB.bind(Object(d.a)(a)),a.setSpeed=a.setSpeed.bind(Object(d.a)(a)),a.setPitch=a.setPitch.bind(Object(d.a)(a)),a.switchLanguage=a.switchLanguage.bind(Object(d.a)(a)),a}return Object(u.a)(i,[{key:"componentWillUnmount",value:function(){null!==this.audioCtx&&this.audioCtx.close()}},{key:"render",value:function(){var e=this;return Object(F.jsxs)("div",{className:"App",children:[ge.title,Object(F.jsx)("br",{}),Object(F.jsxs)("center",{children:["(language) \u2002",Object(F.jsx)("span",{className:"tiny-button",children:Object(F.jsx)(S.a,{title:ge.switchLang,children:Object(F.jsx)("button",{onClick:this.switchLanguage,children:"ja"===this.state.language?"EN":"JP"})})}),"\u2002(AudioWorklet)",Object(F.jsx)(S.a,{title:ge.worklet,children:Object(F.jsx)(B.a,{name:"toggleWorklet",onClick:function(){false},children:Object(F.jsx)(Y.a,{color:this.state.useAudioWorklet?"primary":"disabled"})})})]}),Object(F.jsx)("hr",{}),Object(F.jsxs)("span",{className:"selectFile",children:[Object(F.jsx)(S.a,{title:ge.fileReader,children:Object(F.jsx)("input",{type:"file",name:"loadFiles",multiple:!0,accept:"audio/*",onChange:this.loadFiles})}),"\u2003",Object(F.jsx)("span",{className:"tiny-button",children:Object(F.jsx)(S.a,{title:ge.clearFiles,children:Object(F.jsx)("button",{name:"clearFile",onClick:function(){e.setState({gains:[],playButtonNextAction:"load files first!"}),e.inputAudio=[]},children:ge.clearButton})})}),Object(F.jsx)("br",{})]}),Object(F.jsx)("br",{}),Object(F.jsxs)("div",{className:"text-divider",children:[ge.timeTitle,"\xa0 (",ge.timeSliderPosition,":\xa0",Object(F.jsx)("font",{color:"green",children:this.state.playingAt.toFixed(2)}),")"]}),Object(F.jsxs)("center",{children:["A: ",this.state.timeA.toFixed(2)," -- B: ",this.state.timeB.toFixed(2),"\u2003 song length: ",this.inputAudio[0]?this.inputAudio[0].data.duration.toFixed(2):0,Object(F.jsx)("br",{}),Object(F.jsx)("div",{className:"slider",children:Object(F.jsx)(S.a,{title:ge.timeSlider,children:Object(F.jsx)("input",{type:"range",name:"timeSlider",min:"0",max:this.inputAudio[0]?this.inputAudio[0].data.duration:0,value:this.state.playingAt,onChange:this.handleTimeSlider})})}),Object(F.jsxs)("span",{className:"tiny-button",children:[Object(F.jsx)(S.a,{title:ge.setA,children:Object(F.jsx)("button",{name:"setA",onClick:function(){return e.setState({timeA:e.state.playingAt})},children:"set A"})}),"\u2003",Object(F.jsx)(S.a,{title:ge.setB,children:Object(F.jsx)("button",{name:"setB",onClick:function(){return e.setState({timeB:e.state.playingAt})},children:"set B"})}),"\u2003",Object(F.jsx)(S.a,{title:ge.resetAB,children:Object(F.jsx)("button",{name:"reset",onClick:function(){return e.setState({timeA:0,timeB:e.inputAudio[0].data.duration})},children:"reset"})})]})]}),Object(F.jsx)("div",{className:"text-divider",children:ge.playerTitle}),Object(F.jsxs)("center",{children:[Object(F.jsx)(S.a,{title:ge.record,children:Object(F.jsx)(B.a,{onClick:function(){return e.setState({micOn:!e.state.micOn})},children:Object(F.jsx)(te.a,{color:this.state.micOn?"secondary":"primary"})})}),Object(F.jsx)(_,{nextAction:this.state.playButtonNextAction,handler:this.handlePlay,messages:ge}),Object(F.jsx)(S.a,{title:ge.stopButton,children:Object(F.jsx)(B.a,{onClick:function(){return e.handlePlay({target:{name:"stop"}})},children:Object(F.jsx)(J.a,{color:this.inputAudio.length?"primary":"disabled"})})}),Object(F.jsx)(S.a,{title:ge.loopButton,children:Object(F.jsx)(B.a,{onClick:function(){e.setState({loop:!e.state.loop})},children:Object(F.jsx)(Z.a,{color:this.state.loop?"secondary":"primary"})})}),Object(F.jsx)(S.a,{title:ge.exportButton,"aria-label":"exportFile",children:Object(F.jsx)(B.a,{onClick:function(){return e.handlePlay({target:{name:"exportFile"}})},children:Object(F.jsx)(z.a,{color:!this.inputAudio.length||this.state.isPlaying?"disabled":"primary"})})}),Object(F.jsx)(S.a,{title:ge.playMixButton,"aria-label":"playMix",children:Object(F.jsx)(B.a,{onClick:function(){return e.handlePlay({target:{name:"playMix"}})},children:Object(F.jsx)($.a,{color:!this.inputAudio.length||this.state.isPlaying?"disabled":"primary"})})}),Object(F.jsx)(S.a,{title:ge.bypassButton,children:Object(F.jsx)(B.a,{onClick:function(){return e.setState({bypass:!e.state.bypass})},children:Object(F.jsx)(Q.a,{color:this.state.bypass?"disabled":"primary"})})})]}),this.state.bypass?"":Object(F.jsx)(R,{playSpeed:this.state.playSpeed,playPitch:this.state.playPitch,setSpeed:this.setSpeed,setPitch:this.setPitch,messages:ge}),Object(F.jsxs)("div",{className:"slider",children:[Object(F.jsxs)("div",{className:"text-divider",children:[ge.masterGainTitle,"\xa0 (",this.state.masterGain,")"]}),Object(F.jsxs)("center",{children:["0 ",Object(F.jsx)("input",{type:"range",id:"master",name:"gainSlider",min:"0",max:"150",value:this.state.masterGain,onChange:this.handleGainSlider})," 150"]})]},"master"),Object(F.jsx)("div",{className:"text-divider",children:ge.trackGainTitle}),Object(F.jsx)(D,{inputAudio:this.inputAudio,gains:this.state.gains,handler:this.handleGainSlider}),Object(F.jsx)("hr",{}),ge.version,": ",he," \xa0\xa0",Object(F.jsx)("a",{href:ge.url,target:"_blank",rel:"noreferrer",children:ge.guide}),Object(F.jsx)("br",{}),ge.credit,"\xa0",Object(F.jsx)("a",{href:"https://github.com/cutterbl/SoundTouchJS",target:"_blank",rel:"noreferrer",children:"SoundTouchJs"}),Object(F.jsx)("br",{}),Object(F.jsx)("hr",{})]})}},{key:"loadFiles",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var i,a,n,s=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("loadFiles"===t.target.name){e.next=2;break}return e.abrupt("return");case 2:if(0!==t.target.files.length){e.next=4;break}return e.abrupt("return");case 4:if(i=t.target.files,console.log("loadFiles"),null!==this.audioCtx){e.next=18;break}return console.log("AudioContext"),e.prev=8,this.audioCtx=new AudioContext,e.next=12,this.loadModule(this.audioCtx,"worklet/bundle.js");case 12:console.log("AudioContext worklet module loaded"),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(8),console.log(e.t0);case 18:for(a=function(e){var t=new FileReader;t.onload=function(a){this.audioCtx.decodeAudioData(t.result,function(t){if(2===t.numberOfChannels){this.inputAudio.push({name:i[e].name,data:t,source:null,gainNode:null,gain:100});var a=this.state.gains;a.push(100),this.setState({playButtonNextAction:"Play",timeA:0,playingAt:0,timeB:this.inputAudio[0].data.duration,gains:a})}else alert("Sorry, only stereo files are supported")}.bind(this),(function(e){console.log("decode error: "+e.err)}))}.bind(s),t.onerror=function(e){console.log("File read ",t.error)},t.readAsArrayBuffer(i[e])},n=0;n<i.length;n++)a(n);case 20:case"end":return e.stop()}}),e,this,[[8,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleTimeSlider",value:function(e){"timeSlider"===e.target.name&&(this.state.isPlaying||this.setState({playingAt:parseFloat(e.target.value)}))}},{key:"handlePlay",value:function(e){if(console.log("handlePlay name/button",e.target.name,this.state.playButtonNextAction),0===this.inputAudio.length&&alert(ge.alert),"startPause"!==e.target.name){if("stop"===e.target.name)return this.shifter&&this.shifter.stop(),this.mixedSource&&this.mixedSource.stop(),void this.setState({loop:!1,playButtonNextAction:"Play",playingAt:this.state.timeA});if("exportFile"!==e.target.name&&"playMix"!==e.target.name);else{if(0===this.inputAudio.length||this.state.isPlaying)return;var t=me;this.playAB(0,this.state.timeA,this.state.timeB,!0,t,e.target.name)}}else switch(this.state.playButtonNextAction){case"Pause":console.log("Pause"),this.audioCtx&&this.audioCtx.suspend(),this.setState({playButtonNextAction:"Resume",isPlaying:!1});break;case"Resume":console.log("Resume"),"suspended"===this.audioCtx.state&&this.audioCtx.resume(),this.setState({playButtonNextAction:"Pause",isPlaying:!0});break;case"Play":if(console.log("Play"),0===this.inputAudio.length)break;this.playAB(0,this.state.timeA,this.state.timeB),this.setState({playButtonNextAction:"Pause"});break;default:console.log("default",this.state.playButtonNextAction)}}},{key:"handleGainSlider",value:function(e){if("gainSlider"===e.target.name){if("master"===e.target.id)return this.setState({masterGain:parseFloat(e.target.value)}),void(this.masterGainNode&&(this.masterGainNode.gain.value=parseFloat(e.target.value/100)));var t=parseInt(e.target.id),i=this.state.gains;i[t]=parseInt(e.target.value),this.setState({gains:i}),null!==this.inputAudio[t].gainNode&&(this.inputAudio[t].gainNode.gain.value=parseFloat(e.target.value/100))}}},{key:"setSpeed",value:function(e){var t=this.state.playSpeed;switch(e.target.name){case"sub10":t-=.1;break;case"add10":t+=.1;break;case"sub1":t-=.01;break;case"add1":t+=.01}t<.5?t=.5:t>2&&(t=2),this.shifter&&(this.shifter.tempo=t),this.setState({playSpeed:t})}},{key:"setPitch",value:function(e){var t=this.state.playPitch;switch(e.target.name){case"sub1":t-=1;break;case"add1":t+=1;break;case"sub10c":t-=.1;break;case"add10c":t+=.1}t<-12?t=-12:t>12&&(t=12),this.shifter&&(this.shifter.pitch=Math.pow(2,t/12)),this.setState({playPitch:t})}},{key:"switchLanguage",value:function(e){"ja"===this.state.language?(ge=E.en,this.setState({language:"en"})):(ge=E.ja,this.setState({language:"ja"}))}},{key:"playAB",value:function(){var e=Object(l.a)(o.a.mark((function e(t,i,a){var n,s,r,l,c,u,d,h,p,g,f,m,b,j,x,O,v=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=v.length>3&&void 0!==v[3]&&v[3],s=v.length>4&&void 0!==v[4]&&v[4],r=v.length>5&&void 0!==v[5]?v[5]:"none",console.log("playAB","delay, timeA, timeB, recording, offline, exporter = ",t,i,a,n,s,r),!this.state.isPlaying){e.next=6;break}return e.abrupt("return");case 6:for("suspended"===this.audioCtx.state&&this.audioCtx.resume(),l=this.inputAudio[0].data.sampleRate,c=this.inputAudio[0].data.numberOfChannels,u=(a-i)*l,d=Math.max(u,u/this.state.playSpeed),h=null,s?(h=new OfflineAudioContext(c,1.1*d,l),console.log("OfflineAudioContext Worklet module loaded"),OfflineAudioContext.suspend&&h.suspend()):h=this.audioCtx,this.setState({isPlaying:!0}),p=1,s&&(p=10),g=null,this.state.useAudioWorklet||((g=new y(h,u,4096,n,this.state.bypass)).updateInterval=p),s||(this.shifter=g),g.tempo=this.state.playSpeed,g.pitch=Math.pow(2,this.state.playPitch/12),f=0;f<this.inputAudio.length;f++)(m=h.createBufferSource()).buffer=0===f?this.addZeros(h,this.inputAudio[f].data):this.inputAudio[f].data,this.inputAudio[f].source=m,(b=h.createGain()).gain.value=this.state.gains[f]/100,this.inputAudio[f].gainNode=b,m.connect(b),b.connect(g.node);for(s?g.node.connect(h.destination):((j=h.createGain()).gain.value=this.state.masterGain/100,this.masterGainNode=j,g.node.connect(j),j.connect(h.destination)),x=h.currentTime+t,O=0;O<this.inputAudio.length;O++)this.inputAudio[O].source.start(x,i);s&&(console.log("startRendering"),h.startRendering()),g.onUpdate=function(e){this.setState({playingAt:i+e})}.bind(this),s&&(h.oncomplete=function(e){console.log("Offline render complete (data is useless though) length = ",e.renderedBuffer.length)}),g.onEnd=function(e){console.log("shifter onEnd");for(var t=0;t<this.inputAudio.length;t++)this.inputAudio[t].gainNode.disconnect();if(this.setState({isPlaying:!1}),"exportFile"===r)console.log("exportFile",e.length),g.exportToFile("mix_"+Date.now()+".wav"),this.setState({isPlaying:!1});else if("playMix"===r){console.log("playMix",e.length);var i=this.audioCtx;this.setState({isPlaying:!0,playButtonNextAction:"Pause"});var a=i.createBufferSource();this.mixedSource=a,a.buffer=e;var n=i.createGain();this.masterGainNode=n,n.gain.value=this.state.masterGain/100,a.connect(this.masterGainNode),n.connect(i.destination),a.start(),a.onended=function(e){this.mixedSource=null,this.setState({isPlaying:!1})}.bind(this)}}.bind(this);case 29:case"end":return e.stop()}}),e,this)})));return function(t,i,a){return e.apply(this,arguments)}}()},{key:"addZeros",value:function(e,t){console.log("addZeros");for(var i=e.createBuffer(t.numberOfChannels,2*t.length*1.05,t.sampleRate),a=0;a<i.numberOfChannels;a++){var n=t.getChannelData(a);i.getChannelData(a).set(n)}return i}}]),i}(a.Component),je=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function xe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var i=e.installing;null!=i&&(i.onstatechange=function(){"installed"===i.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var ye=function(e){e&&e instanceof Function&&i.e(3).then(i.bind(null,106)).then((function(t){var i=t.getCLS,a=t.getFID,n=t.getFCP,s=t.getLCP,r=t.getTTFB;i(e),a(e),n(e),s(e),r(e)}))};void 0===AudioWorkletNode?s.a.render(Object(F.jsx)(be,{}),document.getElementById("root")):s.a.render(Object(F.jsx)(de,{}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");je?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(i){var a=i.headers.get("content-type");404===i.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):xe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):xe(t,e)}))}}(),ye()}},[[85,1,2]]]);
//# sourceMappingURL=main.2f6ce69c.chunk.js.map