<HTML>
<HEAD>
<title>KG's ピッチ/速度可変プレーヤ</title>
<META charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</HEAD>
<BODY>

<H1>KG's ピッチ/速度可変プレーヤ</H1>

<font size="3"><A HREF="index.html">Go to English page</A></font>

<P>
ファイルサイズ 700kB 未満<BR>
soundtouchjs module使用: <A HREF="https://github.com/cutterbl/SoundTouchJS">
https://github.com/cutterbl/SoundTouchJS</A>
</P>
以下のスクリーンショット(リンクは同じ)をクリック。
起動後に右上の「日本語」をクリックすると日本語表示に変わります。
(現在は、自動で日本語表示)

<HR>
<A HREF="20210220/">
<img src="player-eng.png" width = "320" border = "3">
<img src="player-jp.png" width = "320" border = "3">
</A>
<HR>

<H2>0. 動作確認 </H2>

<UL>
<LI>(動作安定) Linux -- Firefox, Chrome
<LI>(動作安定) Windows 10 -- Edge (Windows標準、IEは試してない)
<LI>(動作安定) macOS -- Safari (macOS標準)
<LI>(動作安定) Android Phone -- mobile Chrome (Android標準)
<LI>(ときどき不安定) iPhone 6/iPodTouch mobile Safari (iPhone標準)
</UL>

プログラムはJavaScriptで書きました。
したがって、すべての計算はブラウザ内で実行されます。
一度使ったら、オフラインでも使用できます。
気にいったら「ホーム画面」に追加してください。

<HR>
<H2>1. 特長</H2>

<OL>
<LI>同じプログラム (ほんの700kB) が色々な機器で動く
<LI>インストール作業不要、オフラインで動く
<LI>スロー再生はドラマー、ギタリスト、ピアニスト、ボーカリストに役立つ
<LI>詳細ピッチ調整はボーカリスト、ギタリスト、ピアニストなどに役立つ
<LI>ピッチ/速度変更後の音声がwavファイルでダウンロード保存できる
(ダウンロードはローカルなのでネットワーク接続不要)
</OL>

<HR>
<H2>2. 簡単な使い方説明</H2>

音声ファイルをローカルディスクかクラウドに用意する
(wav, mp3など、各装置で再生できる形式)。
iOS(iPhone) には iCloud Drive、Android には Google Driveが便利

<H3>(参考) テスト用音源 (著作権フリー)</H3>

<UL>
<LI><A HREF="Blues_Practice-solo-complete.mp3">譜面ソフトウェアの音</A>(201秒)
<LI><A HREF="sample30sec.mp3">上記の先頭部分</A>(30秒)
<LI><A HREF="Tamaranaize.mp3">たまらないぜ/酔麻痴草(1981)</A>(240秒, mp3 5.7MB)
</UL>

ダウンロードしてローカルディスクかクラウドドライブに保存してから、
このプログラムで開いてください。
iPhoneのSafariでは、多分ダウンロードしたファイルが開けないので、
一度iCloud Driveに保存する必要があるでしょう。

<H3>ボタンとスライダ</H3>

<UL>
<LI>表示言語選択(再生していないときに可能)
<LI>1) 上のオーディオファイル選択でファイルを選ぶ<br />
再生可能なファイルを指定すると "ファイルを読んでね!" が
"一回再生" に変わる
<LI>2A) 通常再生
<UL>
<LI>"一回再生" で一回再生 (一時停止に変わる)
<LI>"一時停止" を押すと一時停止 (一回再生に戻る)
<UL>
<LI>(再生停止中) 時刻スライダーで再生開始位置を変更できる
<LI>(再生停止中) "巻き戻し" で 先頭に戻る
</UL>
<LI>再度 "一回再生" で続き、または指定時刻から再生
</UL>
<LI>2B) 繰り返し再生
<UL>
<LI>"ABループ再生" でループ再生開始
<LI>"ループ停止" でループ停止
<LI>間隔のプルダウンで連続する再生の間隔を指定 (標準 2秒)
</UL>
<LI>A、B の設定 
<UL>
<LI>再生停止中に時刻スライダを動かして 「設定A」「設定B」で決める
<LI>または、再生中に「設定A」「設定B」を押す
</UL>
<LI>スライダー (時刻スライダ以外は再生中に動かしてよい)
<UL>
<LI>速度 (25% to 200%)
<LI>音程(ピッチ) -- 上が半音単位、下は半音の1/100 (セント; cents)
<LI>音量 (標準 80) -- 保存音量には影響しない
</UL>

<LI>3) 書き出し
<UL>
<LI>「再生後書き出し」: 設定したピッチ/速度の音声をwavファイルで書き出す
<LI>「書き出し中止」: 書き出し中止
<LI>"iOSオーディオリセット": iOSで音がおかしくなったときに押すと停まるはず
<LI>補足説明
<UL>
<LI>書き出しには設定速度での再生時間必要
<LI>速度と音程スライダは書き出し中に変更しない (意図的に変更はできる)
<LI>音量スライダでの音量変更は書き出しに影響しない (常に100)
<LI>出力ファイル名は、"originalname&amp;s90&amp;p-188.wav" 
   (speed 80, pitch -1.88) のように自動設定される
<LI><font color="red">iOS12 (古めのiPhone等) では、特別な操作が必要</font>
</UL>
</UL>
</UL>

<HR>
<H2>2. コメント</H2>

<P>
iOS 12 (iPhone6など) での書き出しデータ保存には特別な操作が必要です。
Blob ウィンドウが出てファイル名がunknownになりますが、
それをiCloud Driveにそのまま保存した後、
ファイル名を拡張子 ".wav" を含む文字列に変更します。
もし、保存するときにファイル名を変更できるなら、そのほうが簡単です。
できないのです。
iOS 13ではこの問題は発生しないかもしれませんが、古めの機器には提供されない
ので試せません。
</P>
<P>
保存に曲の再生時間かかるのは無駄ということはわかっていますが、
技術的な問題があり、まだ実装できていません。
使っているsoundtouchjs モジュールがWeb Audio APIの
OfflineAudioContextでは、今のところ動かないのです。
</P>
<HR>

<P>
Source code (JavaScript and sound files)
<A HREF="https://github.com/goto920/nodejs/">
https://github.com/goto920/nodejs/</A>
</P>
<HR>
Contact: goto at kmgoto.jp
</BODY>
</HTML>
