(this.webpackJsonpvariablespeedplayer=this.webpackJsonpvariablespeedplayer||[]).push([[0],{11:function(e){e.exports=JSON.parse('{"name":"variablespeedplayer","version":"0.1.0","private":true,"homepage":".","subversion":"20210711-00","dependencies":{"audiobuffer-to-wav":"^1.0.0","file-saver":"^2.0.5","react":"^16.14.0","react-dom":"^16.14.0","react-scripts":"^3.4.4","soundtouchjs":"^0.1.26","whatwg-fetch":"^3.6.1"},"scripts":{"start":"react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject"},"eslintConfig":{"extends":"react-app"},"browserslist":[">0.2%","not dead","not ie <= 11","not op_mini all"]}')},14:function(e,t,a){e.exports=a(22)},19:function(e,t,a){},20:function(e,t,a){},22:function(e,t,a){"use strict";a.r(t);var n,i,l,r=a(0),o=a.n(r),s=a(10),p=a.n(s),u=(a(19),a(2)),c=a(3),d=a(1),h=a(6),m=a(5),f=(a(20),a(8)),v=a(11),S=a(12),g=a(13),y=a(7),B=v.subversion,b=y.ja,A=y.us;n="ja"===window.navigator.language.slice(0,2)?b:A,window.AudioContext=window.AudioContext||window.webkitAudioContext;var E=null,w=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(e){var i;return Object(u.a)(this,a),(i=t.call(this,e)).params={filename:null,audioBuffer:null,isPlaying:!1,loop:!1,loopInterval:2,exportDataL:null,exportDataR:null,exportBuffer:null,save:!1},i.state={ja:n===b,playingAt:0,playingAtSlider:0,timeA:0,timeB:0,playSpeed:100,playPitch:0,playPitchSemi:0,playPitchCents:0,playVolume:75,startButtonStr:n.loadFile,loopButtonStr:n.loopAB,saveButtonStr:n.exportWav},i.setState=i.setState.bind(Object(d.a)(i)),i.handleWindowClose=i.handleWindowClose.bind(Object(d.a)(i)),i.loadFile=i.loadFile.bind(Object(d.a)(i)),i.handleSpeedSlider=i.handleSpeedSlider.bind(Object(d.a)(i)),i.handlePitchSlider=i.handlePitchSlider.bind(Object(d.a)(i)),i.handleTimeSlider=i.handleTimeSlider.bind(Object(d.a)(i)),i.handleVolumeSlider=i.handleVolumeSlider.bind(Object(d.a)(i)),i.handlePlay=i.handlePlay.bind(Object(d.a)(i)),i.handleSaveB=i.handleSaveB.bind(Object(d.a)(i)),i.fakeDownload=i.fakeDownload.bind(Object(d.a)(i)),i.handleLoop=i.handleLoop.bind(Object(d.a)(i)),i.playAB=i.playAB.bind(Object(d.a)(i)),i.handleLang=i.handleLang.bind(Object(d.a)(i)),i}return Object(c.a)(a,[{key:"handleWindowClose",value:function(e){E&&(E.disconnect(),E.off(),E=null,l.disconnect()),i.close()}},{key:"componentDidMount",value:function(){i=new window.AudioContext,l=i.createGain(),window.addEventListener("beforeClosing",this.handleWindowClose)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeClosing",this.handleWindowClose)}},{key:"render",value:function(){var e,t,a,i=this.loadFile,l=this.handleSpeedSlider,r=this.handlePitchSlider,s=this.handleVolumeSlider,p=this.handleTimeSlider,u=this.handlePlay,c=this.handleSaveB,d=this.handleLoop,h=this.handleLang,m=this.state,f=m.ja,v=m.playingAt,S=m.playingAtSlider,g=m.timeA,y=m.timeB,b=m.playSpeed,A=m.playPitch,E=m.playPitchSemi,w=m.playPitchCents,C=m.playVolume,P=m.startButtonStr,x=m.loopButtonStr,k=m.saveButtonStr,O=0;this.params.audioBuffer&&(O=this.params.audioBuffer.duration),e=P===n.pause?{color:"green"}:{},t=x===n.stopLoop?{color:"green"}:{},a=k===n.abortExport?{color:"green"}:{};var j={border:"1px dotted",color:"blue"};return o.a.createElement("div",{className:"App"},n.title," \xa0\xa0",o.a.createElement("span",{className:"small-button"},o.a.createElement("button",{name:"language",onClick:h},f?"En(US)":"\u65e5\u672c\u8a9e")),o.a.createElement("hr",null),"1) ",n.input,": ",o.a.createElement("br",null),o.a.createElement("span",{className:"selectFile"},o.a.createElement("input",{type:"file",name:"loadFile",accept:"audio/*,.wav,.mp3,.aac,.m4a,.opus",onChange:i}),o.a.createElement("br",null)),o.a.createElement("hr",null),n.speed,": ",b," \xa0\xa0",o.a.createElement("button",{name:"reset",onClick:l},n.reset),o.a.createElement("br",null),o.a.createElement("span",{className:"slider"},o.a.createElement("center",null,"025",o.a.createElement("input",{type:"range",name:"speedSlider",min:"25",max:"200",value:b,onChange:l}),"200")),o.a.createElement("hr",null),n.pitch,": ",parseFloat(A).toFixed(2)," \xa0\xa0",o.a.createElement("button",{name:"reset",onClick:r},n.reset),o.a.createElement("br",null),o.a.createElement("span",{className:"slider"},o.a.createElement("center",null,"-12",o.a.createElement("input",{type:"range",name:"pitchSliderSemi",min:"-12",max:"12",value:E,onChange:r}),"12",o.a.createElement("br",null),o.a.createElement("hr",{style:j}),"-100",o.a.createElement("input",{type:"range",name:"pitchSliderCents",min:"-100",max:"100",value:w,onChange:r}),"100",o.a.createElement("br",null))),o.a.createElement("hr",null),n.time,": ",v.toFixed(2)," \xa0 ",n.timeNote,o.a.createElement("br",null),o.a.createElement("span",{className:"slider"},o.a.createElement("center",null,"0",o.a.createElement("input",{type:"range",name:"timeSlider",min:"0",max:O,value:S,step:"1",onChange:p}),Math.round(O),o.a.createElement("br",null)),o.a.createElement("button",{name:"setA",onClick:d},n.setA),": ",g.toFixed(2)," \xa0\xa0",o.a.createElement("button",{name:"setB",onClick:d},n.setB),": ",y.toFixed(2)," \xa0\xa0",o.a.createElement("button",{name:"resetAB",onClick:d},n.resetAB)),o.a.createElement("hr",null),n.volume,": ",C," \xa0\xa0 ",n.volumeNote,o.a.createElement("br",null),o.a.createElement("span",{className:"slider"},o.a.createElement("center",null,"0",o.a.createElement("input",{type:"range",name:"volumeSlider",min:"0",max:"150",value:C,onChange:s}),"150",o.a.createElement("br",null))),o.a.createElement("hr",null),o.a.createElement("span",null,"2A) ",o.a.createElement("button",{name:"startPause",onClick:u,style:e},P)," \xa0\xa0",o.a.createElement("button",{name:"Rewind",onClick:d},n.rewind),o.a.createElement("hr",{style:j}),"2B) ",o.a.createElement("button",{name:"LoopAB",onClick:d,style:t},x)," \xa0\xa0",n.interval," ",o.a.createElement("span",{className:"selector"},o.a.createElement("select",{name:"loopInterval",defaultValue:this.params.loopInterval,onChange:d},o.a.createElement("option",{value:"0"},"00"),o.a.createElement("option",{value:"1"},"01"),o.a.createElement("option",{value:"2"},"02"),o.a.createElement("option",{value:"4"},"04"),o.a.createElement("option",{value:"5"},"05"),o.a.createElement("option",{value:"10"},"10"),o.a.createElement("option",{value:"20"},"20"),o.a.createElement("option",{value:"30"},"30"),o.a.createElement("option",{value:"60"},"60"))),o.a.createElement("hr",null),"3) ",o.a.createElement("button",{name:"save",onClick:c,style:a},k)),o.a.createElement("hr",null),n.version,": ",B,", \xa0",o.a.createElement("a",{href:n.homepage,target:"_blank",rel:"noopener noreferrer"},n.guide),o.a.createElement("br",null),"Based on ",o.a.createElement("a",{href:"https://github.com/cutterbl/SoundTouchJS",target:"_blank",rel:"noopener noreferrer"},"cutterbl/SoundTouchJS"))}},{key:"loadFile",value:function(e){if("loadFile"===e.target.name&&0!==e.target.files.length&&!this.params.isPlaying){this.setState({totalTime:0}),this.setState({startButtonStr:n.playOnce});var t=e.target.files[0];this.params.filename=t.name;var a=new FileReader;i&&i.close(),i=new window.AudioContext,l=i.createGain(),a.onload=function(e){i.decodeAudioData(a.result,function(e){this.params.saudioBuffer=null,this.params.audioBuffer=e,this.setState({startButtonStr:n.playOnce,playingAt:0,playingAtSlider:0}),this.setState({timeA:0}),this.setState({timeB:e.duration})}.bind(this),(function(e){console.log("Filereader error: "+e.err)}))}.bind(this),a.readAsArrayBuffer(t)}}},{key:"handleSpeedSlider",value:function(e){return"speedSlider"===e.target.name?(E&&(E.tempo=e.target.value/100),void this.setState({playSpeed:e.target.value})):"reset"===e.target.name?(E&&(E.tempo=1),void this.setState({playSpeed:100})):void 0}},{key:"handlePitchSlider",value:function(e){var t=0;"pitchSliderSemi"===e.target.name?(t=parseFloat(e.target.value)+parseFloat(this.state.playPitchCents)/100,this.setState({playPitchSemi:e.target.value})):"pitchSliderCents"===e.target.name?(t=parseFloat(this.state.playPitchSemi)+parseFloat(e.target.value)/100,this.setState({playPitchCents:e.target.value})):"reset"===e.target.name&&(this.setState({playPitchSemi:0,playPitchCents:0}),t=0),E&&(E.pitch=Math.pow(2,t/12)),this.setState({playPitch:t})}},{key:"handleTimeSlider",value:function(e){if("timeSlider"===e.target.name&&this.state.startButtonStr===n.playOnce){var t=e.target.value;this.setState({playingAt:parseFloat(t)}),this.setState({playingAtSlider:t})}}},{key:"handleVolumeSlider",value:function(e){if("volumeSlider"===e.target.name){var t=1*e.target.value;l.gain.value=t/100,this.setState({playVolume:t})}}},{key:"handlePlay",value:function(e){var t=this.params.audioBuffer;if("startPause"===e.target.name){var a,r;if("suspended"===i.state&&i.resume(),this.state.startButtonStr===n.pause){if(!this.params.isPlaying)return;if(null===E)return;return E.disconnect(),E.off(),E=null,l.disconnect(),this.params.isPlaying=!1,this.setState({playingAtSlider:this.state.playingAt}),void this.setState({startButtonStr:n.playOnce})}if("startPause"===e.target.name&&this.state.startButtonStr===n.playOnce){if(this.params.isPlaying)return;return a=this.state.playingAt,r=t.duration,void this.playAB(a,r)}}}},{key:"fakeDownload",value:function(e){var t=this.params.filename.split(".")[0]+"&s"+parseInt(this.state.playSpeed)+"&p"+parseInt(100*this.state.playPitch)+".wav",a=new Blob([g(e)],{type:"audio/vnd.wav"});Object(S.saveAs)(a,t)}},{key:"handleSaveB",value:function(e){var t=this;if("save"===e.target.name&&this.state.startButtonStr===n.playOnce&&this.state.loopButtonStr===n.loopAB){var a=this.params.audioBuffer;if(this.state.saveButtonStr===n.abortExport)return E&&(E.disconnect(),E.off(),E=null,l.disconnect()),this.params.isPlaying=!1,void this.setState({saveButtonStr:n.exportWav});if(this.state.saveButtonStr===n.exportWav){if(this.params.isPlaying)return;if(!a)return;var r=null,o=a.numberOfChannels;E&&(E.disconnect(),E.off(),E=null);(E=new f.a(i,a,16384)).tempo=this.state.playSpeed/100,E.pitch=Math.pow(2,this.state.playPitch/12),r=i.createScriptProcessor(16384,o,o),this.params.exportBuffer=i.createBuffer(o,parseInt(a.length*(100/this.state.playSpeed))+16384,a.sampleRate),this.params.save=!0;var s=0;return AudioBuffer.prototype.copyToChannel?console.log("copyToChannel OK"):console.log("copyToChannel NG"),r.onaudioprocess=function(e){for(var t=e.inputBuffer,a=e.outputBuffer,n=this.params.exportBuffer,i=0;i<t.numberOfChannels;i++){var l=t.getChannelData(i),r=a.getChannelData(i),o=n.getChannelData(i);if(AudioBuffer.prototype.copyToChannel)a.copyToChannel(l,i,0),n.copyToChannel(l,i,s);else for(var p=0;p<t.length;p++){var u=l[p];r[p]=u,o[s+p]=u}}s+=t.length}.bind(this),E.on("play",(function(e){var a=parseFloat(e.timePlayed);if(t.setState({playingAt:a,playingAtSlider:a}),e.formattedTimePlayed>=E.formattedDuration)return r.disconnect(),E.off(),E.disconnect(),E=null,l.disconnect(),t.fakeDownload(t.params.exportBuffer),t.params.isPlaying=!1,t.setState({saveButtonStr:n.exportWav}),void(t.params.save=!1)})),this.setState({saveButtonStr:n.abortExport}),this.params.isPlaying=!0,E.connect(r),r.connect(l),l.connect(i.destination),void("suspended"===i.state&&i.resume())}}}},{key:"handleLoop",value:function(e){if("loopInterval"!==e.target.name){if("Rewind"===e.target.name){if(this.params.isPlaying)return;return this.setState({playingAt:0}),void this.setState({playingAtSlider:0})}if("setA"===e.target.name)return this.setState({timeA:this.state.playingAt}),void this.setState({playingAtSlider:this.state.playingAt});if("setB"!==e.target.name)if("LoopAB"!==e.target.name)if("resetAB"!==e.target.name);else{if(null===this.params.audioBuffer)return;this.setState({timeA:0,timeB:this.params.audioBuffer.duration,playingAtSlider:0})}else{if(!this.params.audioBuffer)return;if(this.state.loopButtonStr===n.loopAB){if(this.params.isPlaying)return;this.params.loop=!0,this.playAB(this.state.timeA,this.state.timeB),this.setState({loopButtonStr:n.stopLoop}),this.setState({startButtonStr:n.playOnce})}else if(this.state.loopButtonStr===n.stopLoop){if(!this.params.isPlaying)return;E&&(E.disconnect(),E.off(),E=null,l.disconnect()),this.params.isPlaying=!1,this.params.loop=!1,this.setState({loopButtonStr:n.loopAB})}}else this.state.playingAt>=this.state.timeA?this.setState({timeB:parseFloat(this.state.playingAt)}):this.setState({timeB:parseFloat(this.state.timeA)+parseFloat(10)})}else this.params.loopInterval=parseInt(e.target.value,10)}},{key:"playAB",value:function(e,t){var a=this;if(!this.params.isPlaying&&null!==this.params.audioBuffer){"suspended"===i.state&&i.resume(),t<=e&&(t=e+5,this.setState({timeB:t}));var r=this.params,o=r.audioBuffer,s=r.loopInterval,p=e*o.sampleRate,u=t*o.sampleRate,c=0;this.params.loop&&(c=s*o.sampleRate);var d=i.createBuffer(2,u-p+c,o.sampleRate),h=o.getChannelData(0),m=o.getChannelData(1);h=h.subarray(p,u);for(var v=d.getChannelData(0),S=0;S<h.length;S++)v[S+c]=h[S];if(o.numberOfChannels>=2){v=d.getChannelData(1),m=m.subarray(p,u);for(var g=0;g<m.length;g++)v[g+c]=m[g]}v=null;E&&(E.disconnect(),E.off(),E=null),E=new f.a(i,d,16384),d=null,E.tempo=this.state.playSpeed/100,E.pitch=Math.pow(2,this.state.playPitch/12);var y=E.formattedDuration;E.on("play",(function(t){var i=parseFloat(e)+parseFloat(t.timePlayed);if(a.params.loop&&(i-=s),a.setState({playingAt:i,playingAtSlider:i}),t.formattedTimePlayed>=y)return E.off(),E.disconnect(),E=null,l.disconnect(),a.params.isPlaying=!1,a.state.startButtonStr===n.pause&&a.setState({playingAt:0,playingAtSlider:0,startButtonStr:n.playOnce}),void(a.params.loop&&a.playAB(a.state.timeA,a.state.timeB))})),E.connect(l),l.connect(i.destination),this.params.isPlaying=!0,this.params.loop||this.setState({startButtonStr:n.pause})}}},{key:"handleLang",value:function(e){if(!this.params.isPlaying&&"language"===e.target.name){var t=n;return this.state.ja?(n=A,this.setState({ja:!1})):(n=b,this.setState({ja:!0})),this.state.startButtonStr===t.loadFile?this.setState({startButtonStr:n.loadFile}):this.state.startButtonStr===t.playOnce?this.setState({startButtonStr:n.playOnce}):this.state.startButtonStr===t.pause&&this.setState({startButtonStr:n.pause}),this.state.loopButtonStr===t.loopAB?this.setState({loopButtonStr:n.loopAB}):this.state.loopButtonStr===t.stopLoop&&this.setState({loopButtonStr:n.stopLoop}),void(this.state.saveButtonStr===t.exportWav?this.setState({saveButtonStr:n.exportWav}):this.state.saveButtonStr===t.abortExport&&this.setState({saveButtonStr:n.abortExport}))}}}]),a}(r.Component),C=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function P(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}p.a.render(o.a.createElement(w,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");C?(!function(e,t){fetch(e).then((function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):P(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")}))):P(t,e)}))}}()},7:function(e){e.exports=JSON.parse('{"us":{"title":"KG\'s variable speed/pitch player","input":"Select audio file (local/cloud storage)","speed":"Speed(%)","reset":"Reset","pitch":"Pitch(semitone.cents)","time":"Time(sec)","timeNote":"(Start pos., A, B set)","setA":"setA","setB":"setB","resetAB":"ResetAB","volume":"Volume(%)","volumeNote":"(May change during export)","loadFile":"selectFile!","playOnce":"PlayOnce","pause":"Pause","rewind":"Rewind","loopAB":"loopAB","stopLoop":"StopLoop","interval":"interval(sec)","exportWav":"ExportAfterPlayback","abortExport":"AbortExport","resetAudio":"iOSAudioReset","version":"Version","guide":"guide/update","homepage":"https://goto920.github.io/demos/variableplayer/"},"ja":{"title":"KG\'s \u901f\u5ea6/\u97f3\u7a0b\u53ef\u5909\u30d7\u30ec\u30fc\u30e4","input":"\u30aa\u30fc\u30c7\u30a3\u30aa\u30fb\u30d5\u30a1\u30a4\u30eb\u9078\u629e (\u30ed\u30fc\u30ab\u30eb/\u30af\u30e9\u30a6\u30c9)","speed":"\u901f\u5ea6(%)","reset":"\u30ea\u30bb\u30c3\u30c8","pitch":"\u97f3\u7a0b(\u534a\u97f3.\u534a\u97f3\u306e1/100)","time":"\u6642\u523b(\u79d2)","timeNote":"(\u518d\u751f\u958b\u59cb\u4f4d\u7f6e, A, B\u8a2d\u5b9a)","setA":"\u8a2d\u5b9aA","setB":"\u8a2d\u5b9aB","resetAB":"\u30ea\u30bb\u30c3\u30c8AB","volume":"\u97f3\u91cf(%)","volumeNote":"(\u66f8\u304d\u51fa\u3057\u4e2d\u5909\u66f4\u53ef)","loadFile":"\u30d5\u30a1\u30a4\u30eb\u3092\u9078\u3093\u3067\u306d!","playOnce":"\u4e00\u56de\u518d\u751f","pause":"\u4e00\u6642\u505c\u6b62","rewind":"\u5dfb\u304d\u623b\u3057","loopAB":"AB\u30eb\u30fc\u30d7\u518d\u751f","stopLoop":"\u30eb\u30fc\u30d7\u505c\u6b62","interval":"\u9593\u9694(\u79d2)","exportWav":"\u518d\u751f\u5f8c\u66f8\u304d\u51fa\u3057","abortExport":"\u66f8\u304d\u51fa\u3057\u4e2d\u6b62","resetAudio":"iOS\u30aa\u30fc\u30c7\u30a3\u30aa\u30ea\u30bb\u30c3\u30c8","version":"\u7248","guide":"\u30ac\u30a4\u30c9/\u66f4\u65b0","homepage":"https://goto920.github.io/demos/variableplayer/index-jp.html"}}')}},[[14,1,2]]]);
//# sourceMappingURL=main.6835955b.chunk.js.map